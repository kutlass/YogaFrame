CREATE FUNCTION MemberValidateCredentials (
    varcharAlias VARCHAR(15),
	varcharPassword VARCHAR(45))
    RETURNS BOOLEAN
    DETERMINISTIC
BEGIN
    DECLARE fValidateSuccess BOOLEAN;
    DECLARE dwMemberId INT;
    SET fValidateSuccess = FALSE;
    SELECT IdtblMembers INTO dwMemberId FROM tbl_Members WHERE ColNameAlias=varcharAlias;
    IF dwMemberId > 0 THEN
	    SET dwMemberid = 0;
	    SELECT IdtblMembers INTO dwMemberId FROM tbl_Members WHERE ColPasswordSaltHash=varcharPassword;
	    IF dwMemberId > 0 THEN
            SET fValidateSuccess = TRUE;
        ELSE
            SET fValidateSuccess = FALSE;
        END IF;
    ELSE
        SET fValidateSuccess = FALSE;
    END IF;

    RETURN fValidateSuccess;
END;
